#!/bin/sh
source=${1?Missing source file}

exec >atoms.h

for_each_atom() {
	sed -n '/ATOM_NAMES/,$ {/^\s*"/{s/.*"\([^"]*\)".*/'"$*"'/;p};/^}/q}' "$source"
}

echo "/* Generated automatically by $0. Do not edit. */"
echo 'enum {'
for_each_atom '\tHEAWM_ATOM_\1,'
echo '};'
echo
echo '#define ATOM(name) ((xcb_atom_t const)atoms[HEAWM_ATOM_##name])'
