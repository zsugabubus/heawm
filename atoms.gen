#!/bin/sh
file=$1

exec >atoms.h

for_each_atom() {
	sed -n '/ATOM_NAMES/,$ {/^\s*"/{s/.*"\([^"]*\)".*/'"$*"'/;p};/^}/q}' "$file"
}

echo "/* Generated automatically by $0. Do not edit. */"
echo 'enum {'
for_each_atom '\tATOM_\1,'
echo '};'
echo
echo '#define ATOM(name) ((xcb_atom_t const)atoms[ATOM_##name])'
echo
